<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Ä°ÅŸlem GeÃ§miÅŸi</title>
    <style>
    body
    {
        margin:0;
        height:100vh;
        display:flex;
        font-family:Segoe UI, sans-serif;
        background:#f3f4f6;
    }

    .sidebar
    {
        width:220px;
        background:#1f2933;
        color:white;
        padding:20px;
    }
    
    .sidebar h2
    {
        text-align:center;
        margin-bottom:30px;
    }
    
    .sidebar button
    {
        width:100%;
        padding:12px;
        margin:8px 0;
        background:none;
        border:none;
        color:white;
        text-align:left;
        cursor:pointer;
    }
    
    .sidebar button:hover
    {
        background:#374151;
    }
    
    .logout
    {
        background:#b91c1c !important;
    }

    .content
    {
        flex:1;
        padding:25px;
        display:flex;
        flex-direction:column;
    }

    .page-title
    {
        font-size:32px;
        margin-bottom:15px;
        text-align:center;
    }

    #islemPanel
    {
        flex:1;
        background:white;
        padding:20px;
        border-radius:16px;
        box-shadow:0 6px 18px rgba(0,0,0,.15);
        overflow:auto;
    }

    table
    {
        width:100%;
        border-collapse:collapse;
    }
    
    th,td
    {
        padding:12px 15px;
        border-bottom:1px solid #e5e7eb;
        text-align:left;
    }

    th
    {
        background:#2563eb;
        color:white;
    }

    tr:nth-child(even)
    {
        background:#f9fafb;
    }

    .bottom-controls
    {
        margin-top:20px;
        background:white;
        padding:18px 22px;
        border-radius:16px;
        box-shadow:0 4px 12px rgba(0,0,0,.15);
        display:flex;
        justify-content:flex-end;
    }

    .message
    {
        font-size:18px;
        padding:15px;
        background:#fff3cd;
        color:#856404;
        border-radius:10px;
    }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>Ãœye Paneli</h2>
        <button onclick="window.location.href='{{ url_for('user.kitaplarSayfasi') }}'">ğŸ“š Kitaplar</button>
        <button onclick="window.location.href='{{ url_for('user.kitaplarim') }}'">ğŸ“– KitaplarÄ±m</button>
        <button>âš ï¸ Ceza Bilgi</button>
        <button onclick="window.location.href='{{ url_for('user.islemGecmisi') }}'">ğŸ§¾ Ä°ÅŸlem GeÃ§miÅŸi</button>
        <button onclick="window.location.href='{{ url_for('user.memberInfo') }}'">âš™ï¸ Hesap Bilgileri</button>
        <button class="logout" onclick="window.location.href='{{url_for('user.logout')}}'">ğŸšª Ã‡Ä±kÄ±ÅŸ</button>
    </div>

    <div class="content">

        <div class="page-title">Ä°ÅŸlem GeÃ§miÅŸi</div>

        <div id="islemPanel">
            <p class="message">Veriler yÃ¼kleniyor...</p>
        </div>



    </div>
    <script>
    async function loadLogs()
    {
        const panel = document.getElementById('islemPanel');
        panel.innerHTML = '<p class="message">YÃ¼kleniyor...</p>';
        try{
            const res = await fetch('{{ url_for('user.getUserLogs') }}');
            if(!res.ok) throw new Error('Ä°stek baÅŸarÄ±sÄ±z');
            let data = await res.json();
            if(!Array.isArray(data)) data = [];

            if(data.length == 0){
                panel.innerHTML = '<p class="message">KayÄ±t bulunamadÄ±.</p>';
                return;
            }

            const table = document.createElement('table');
            const thead = document.createElement('thead');
            thead.innerHTML = '<tr><th>#</th><th>UserID</th><th>KullanÄ±cÄ±</th><th>Ä°ÅŸlem</th><th>Tarih</th></tr>';
            table.appendChild(thead);

            const tbody = document.createElement('tbody');
            data.forEach((row, idx)=>{
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${idx+1}</td>
                    <td>${row.userID || ''}</td>
                    <td>${row.username || ''}</td>
                    <td>${row.logMessage || ''}</td>
                    <td>${row.logDate || ''}</td>
                `;
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);
            panel.innerHTML = '';
            panel.appendChild(table);
        }catch(err){
            panel.innerHTML = '<p class="message">Veri yÃ¼klenirken hata oluÅŸtu.</p>';
            console.error(err);
        }
    }

    document.addEventListener('DOMContentLoaded', loadLogs);
    </script>
</body>
</html>
